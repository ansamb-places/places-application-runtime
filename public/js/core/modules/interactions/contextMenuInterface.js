/*
	Places, Copyright 2014 Ansamb.
	
	This file is part of Places By Ansamb.
	
	Places By Ansamb is free software: you can redistribute it and/or modify it
	under the terms of the Affero GNU General Public License as published by the
	Free Software Foundation, either version 3 of the License, or (at your
	option) any later version.
	
	Places By Ansamb is distributed in the hope that it will be useful, but
	WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY
	or FITNESS FOR A PARTICULAR PURPOSE. See the Affero GNU General Public
	License for more details.
	
	You should have received a copy of the Affero GNU General Public License
	along with Places By Ansamb. If not, see <http://www.gnu.org/licenses/>.

*/
// Generated by CoffeeScript 1.7.1
define(['jquery.ui-contextmenu'], function() {
  var contextMenuInterface;
  contextMenuInterface = {
    enhanceView: function(View) {
      var render;
      render = View.prototype.render;
      return View.prototype.render = function() {
        var _ref;
        render.call(this, arguments);
        if (((_ref = this.contextMenu) != null ? _ref.length : void 0) > 0) {
          this.$el.contextmenu({
            preventContextMenuForPopup: true,
            preventSelect: true,
            taphold: true,
            show: false,
            menu: this.contextMenu,
            beforeOpen: (function(_this) {
              return function(event, ui) {
                if (_this.contextMenuInstance.disabled === true) {
                  return false;
                }
                return event.stopPropagation();
              };
            })(this),
            select: (function(_this) {
              return function(event, ui) {
                if (ui.cmd) {
                  return _this.contextMenuInstance.trigger_el.trigger("contextmenu:" + ui.cmd);
                }
              };
            })(this)
          });
          this.contextMenuInstance = {
            change_trigger_el: function(el) {
              return this.trigger_el = el;
            },
            disable: function() {
              return this.disabled = true;
            },
            enable: function() {
              return this.disabled = false;
            },
            reset: (function(_this) {
              return function() {
                _this.$el.contextmenu("replaceMenu", _this.contextMenu);
                _this.contextMenuInstance.trigger_el = _this;
                return _this.contextMenuInstance.disabled = false;
              };
            })(this),
            change_menu: (function(_this) {
              return function(menu) {
                return _this.$el.contextmenu("replaceMenu", menu);
              };
            })(this),
            disabled: false,
            trigger_el: this
          };
        }
        return this;
      };
    }
  };
  contextMenuInterface.enhanceView(Backbone.Marionette.ItemView);
  contextMenuInterface.enhanceView(Backbone.Marionette.CompositeView);
  return contextMenuInterface;
});
